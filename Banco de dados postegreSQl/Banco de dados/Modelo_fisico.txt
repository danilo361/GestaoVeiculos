-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE public.abastecimento
(
    fk_prestadora integer,
    fk_veiculo integer,
    data date,
    tipo_combustivel character varying(30),
    km_atual character varying(300),
    forma_pagamento character varying,
    valor_total character varying,
    qtd_litros character varying,
    valor_litro character varying,
    pk_abastecimento serial NOT NULL,
 PRIMARY KEY ( pk_abastecimento)
);

CREATE TABLE public.movimentacao
(
    fk_pneu integer,
    fk_roda integer,
    data date,
    pk_movimentacao serial NOT NULL,
    fk_veiculo integer,
    PRIMARY KEY (pk_movimentacao)
);

CREATE TABLE public.pneu
(
    pk_pneu serial NOT NULL,
    modelo character varying(30),
    dimensoes character varying(30),
    data_compra date,
    dot character varying(30),
    n_fogo character varying(30),
    indice_carga character varying(30),
    fk_status integer,
    segmento_pneu character varying,
    PRIMARY KEY (pk_pneu)
);

CREATE TABLE public.prestadora
(
    pk_prestadora serial NOT NULL,
    nome character varying(30),
    telefone character varying(30),
    cep character varying(20),
    endereco character varying(200),
    numero character varying,
    segmento character varying,
    cnpj character varying,
    PRIMARY KEY (pk_prestadora)
);

CREATE TABLE public.roda
(
    pk_roda serial NOT NULL,
    posicao character varying(10),
    fk_veiculo integer,
    fk_pneu integer,
    PRIMARY KEY (pk_roda)
);

CREATE TABLE public.servicos
(
    fk_prestadora integer,
    fk_veiculo integer,
    pk_servico serial NOT NULL,
    data date,
    nome_servico character varying(30),
    descricao character varying(300),
    valor_peca character varying,
    valor_total character varying,
    nome_peca character varying,
    valor_maobra character varying,
    PRIMARY KEY (pk_servico)
);

CREATE TABLE public.status
(
    pk_status integer NOT NULL,
    nome character varying(30),
    descricao character varying(200),
    PRIMARY KEY (pk_status)
);

INSERT INTO status (pk_status, nome, descricao) VALUES ('1', 'Disponível', 'Armazenado no almoxarifado'),
					    ('2', 'Indisponível', 'Alocado em um veículo');
CREATE TABLE public.usuario
(
    pk_usuario serial NOT NULL,
    nome character varying(30),
    sobrenome character varying(100),
    email character varying(200),
    tipo character varying(30),
    senha character varying(30),
    status character varying(20) NOT NULL,
    PRIMARY KEY (pk_usuario)
);

CREATE TABLE public.veiculo
(
    pk_veiculo serial NOT NULL,
    modelo character varying(15),
    placa character varying(8),
    ano character varying(4),
    licenciamento character varying(4),
    qtdeixos character varying(10),
    tipo character varying(15),
    PRIMARY KEY (pk_veiculo)
);

INSERT into usuario (nome, sobrenome, email, tipo, senha, status) VALUES ('user', 'admin', 'admin@gmail.com', 'Administrador', 'admin', 'false');

ALTER TABLE public.movimentacao
    ADD FOREIGN KEY (fk_pneu)
    REFERENCES public.pneu (pk_pneu)
    NOT VALID;


ALTER TABLE public.movimentacao
    ADD FOREIGN KEY (fk_roda)
    REFERENCES public.roda (pk_roda)
    NOT VALID;


ALTER TABLE public.movimentacao
    ADD FOREIGN KEY (fk_veiculo)
    REFERENCES public.veiculo (pk_veiculo)
    NOT VALID;


ALTER TABLE public.pneu
    ADD FOREIGN KEY (fk_status)
    REFERENCES public.status (pk_status)
    NOT VALID;


ALTER TABLE public.roda
    ADD FOREIGN KEY (fk_pneu)
    REFERENCES public.pneu (pk_pneu)
    NOT VALID;


ALTER TABLE public.roda
    ADD FOREIGN KEY (fk_veiculo)
    REFERENCES public.veiculo (pk_veiculo)
    NOT VALID;


ALTER TABLE public.servicos
    ADD FOREIGN KEY (fk_prestadora)
    REFERENCES public.prestadora (pk_prestadora)
    NOT VALID;


ALTER TABLE public.servicos
    ADD FOREIGN KEY (fk_veiculo)
    REFERENCES public.veiculo (pk_veiculo)
    NOT VALID;

ALTER TABLE public.abastecimento
    ADD FOREIGN KEY (fk_veiculo)
    REFERENCES public.veiculo (pk_veiculo)
    NOT VALID;

END;